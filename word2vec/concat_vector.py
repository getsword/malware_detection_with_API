import numpy as np

sentence2vector={}
with open('../sentence_embedding/wiki_api_embedding','r',encoding='utf-8') as f:
    for line in f.readlines()[1:]:
        idx = line.index(' ')
        word = line[:idx]
        vector = line[idx + 1:].split(' ')
        vector=[float(i) for i in vector]
        size=len(vector)
        sentence2vector[word] = np.array(vector)

native2vector={}
concat_vector={}
with open('vector/native_vector_50.txt','r',encoding='utf-8') as f:
    for line in f.readlines():
        idx=line.index(' ')
        word=line[:idx]

        separa=word[::-1].find('_')


        if separa==-1:
            api_name=word
        else:
            api_name=word[:len(word)-separa-1]

        if api_name in sentence2vector.keys():
            sensitive=sentence2vector[api_name]
        else:
            sensitive=[float(0) for i in range(size)]

        vector=line[idx+1:].split(' ')
        vector = [float(i) for i in vector]
        native2vector[word]=np.array(vector)

        concat_vector[word]=np.concatenate((native2vector[word],sensitive),axis=0)

with open('vector/concat_vector.txt','w',encoding='utf-8') as f:
    for key,value in concat_vector.items():
        f.write(key+' '+' '.join([str(i) for i in value]))
        f.write('\n')

